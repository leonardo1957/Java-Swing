DROP DATABASE IF EXISTS FARMACIA_DB;
-- MySQL Script generated by MySQL Workbench
-- Mon Jun  3 10:25:44 2019
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema FARMACIA_DB
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema FARMACIA_DB
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `FARMACIA_DB` DEFAULT CHARACTER SET utf8 ;
USE `FARMACIA_DB` ;

-- -----------------------------------------------------
-- Table `FARMACIA_DB`.`FORMA_USO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `FARMACIA_DB`.`FORMA_USO` (
  `ID_FORMA_USO` INT NOT NULL AUTO_INCREMENT,
  `DESCRICAO` VARCHAR(100) NULL,
  PRIMARY KEY (`ID_FORMA_USO`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `FARMACIA_DB`.`LABORATORIO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `FARMACIA_DB`.`LABORATORIO` (
  `ID_LABORATORIO` INT NOT NULL AUTO_INCREMENT,
  `NM_LABORATORIO` VARCHAR(100) NULL,
  PRIMARY KEY (`ID_LABORATORIO`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `FARMACIA_DB`.`REMEDIO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `FARMACIA_DB`.`REMEDIO` (
  `COD_BARRA` CHAR(13) NOT NULL,
  `DOSAGEM` VARCHAR(15) NULL,
  `COMPOSICAO` VARCHAR(100) NULL,
  `GENERICO` TINYINT NULL,
  `NM_REMEDIO` VARCHAR(150) NULL,
  `DT_CADASTRO` DATETIME NULL,
  `PRECO` DOUBLE NULL,
  `ESTOQUE` INT NULL,
  `ID_FORMA_USO` INT NOT NULL,
  `ID_LABORATORIO` INT NOT NULL,
  PRIMARY KEY (`COD_BARRA`),
  INDEX `fk_REM_FORMA_USO_idx` (`ID_FORMA_USO` ASC),
  INDEX `fk_REM_LABORATORIO_idx` (`ID_LABORATORIO` ASC),
  CONSTRAINT `fk_REM_FORMA_USO`
    FOREIGN KEY (`ID_FORMA_USO`)
    REFERENCES `FARMACIA_DB`.`FORMA_USO` (`ID_FORMA_USO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_REM_LABORATORIO`
    FOREIGN KEY (`ID_LABORATORIO`)
    REFERENCES `FARMACIA_DB`.`LABORATORIO` (`ID_LABORATORIO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `FARMACIA_DB`.`CATEGORIA`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `FARMACIA_DB`.`CATEGORIA` (
  `ID_CATEGORIA` INT NOT NULL AUTO_INCREMENT,
  `NM_CATEGORIA` VARCHAR(100) NULL,
  PRIMARY KEY (`ID_CATEGORIA`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `FARMACIA_DB`.`PRODUTO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `FARMACIA_DB`.`PRODUTO` (
  `COD_BARRA` CHAR(13) NOT NULL,
  `NM_PRODUTO` VARCHAR(150) NULL,
  `DT_CADASTRO` DATETIME NULL,
  `PRECO` DOUBLE NULL,
  `ESTOQUE` INT NULL,
  `ID_CATEGORIA` INT NOT NULL,
  PRIMARY KEY (`COD_BARRA`),
  INDEX `fk_PROD_CATEGORIA_idx` (`ID_CATEGORIA` ASC),
  CONSTRAINT `fk_PROD_CATEGORIA`
    FOREIGN KEY (`ID_CATEGORIA`)
    REFERENCES `FARMACIA_DB`.`CATEGORIA` (`ID_CATEGORIA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `FARMACIA_DB`.`VENDA`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `FARMACIA_DB`.`VENDA` (
  `ID_VENDA` INT NOT NULL AUTO_INCREMENT,
  `DT_VENDA` DATETIME NULL,
  `VALOR_TOTAL` DOUBLE NULL,
  PRIMARY KEY (`ID_VENDA`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `FARMACIA_DB`.`ITEM_REMEDIO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `FARMACIA_DB`.`ITEM_REMEDIO` (
  `ID_ITEM_REMEDIO` INT NOT NULL AUTO_INCREMENT,
  `ID_VENDA` INT NOT NULL,
  `COD_BARRA` CHAR(13) NOT NULL,
  `QT_REMEDIO` INT NULL,
  PRIMARY KEY (`ID_ITEM_REMEDIO`),
  INDEX `fk_ITEM_REM_VENDA_idx` (`ID_VENDA` ASC),
  INDEX `fk_ITEM_REM_REMEDIO_idx` (`COD_BARRA` ASC),
  CONSTRAINT `fk_ITEM_REM_VENDA`
    FOREIGN KEY (`ID_VENDA`)
    REFERENCES `FARMACIA_DB`.`VENDA` (`ID_VENDA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ITEM_REM_REMEDIO`
    FOREIGN KEY (`COD_BARRA`)
    REFERENCES `FARMACIA_DB`.`REMEDIO` (`COD_BARRA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `FARMACIA_DB`.`ITEM_PRODUTO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `FARMACIA_DB`.`ITEM_PRODUTO` (
  `ID_ITEM_PRODUTO` INT NOT NULL AUTO_INCREMENT,
  `ID_VENDA` INT NOT NULL,
  `COD_BARRA` CHAR(13) NOT NULL,
  `QT_PRODUTO` INT NULL,
  PRIMARY KEY (`ID_ITEM_PRODUTO`),
  INDEX `fk_ITEM_PROD_VENDA_idx` (`ID_VENDA` ASC),
  INDEX `fk_ITEM_PROD_PRODUTO_idx` (`COD_BARRA` ASC),
  CONSTRAINT `fk_ITEM_PROD_VENDA`
    FOREIGN KEY (`ID_VENDA`)
    REFERENCES `FARMACIA_DB`.`VENDA` (`ID_VENDA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ITEM_PROD_PRODUTO`
    FOREIGN KEY (`COD_BARRA`)
    REFERENCES `FARMACIA_DB`.`PRODUTO` (`COD_BARRA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

INSERT INTO `farmacia_db`.`categoria` (`NM_CATEGORIA`) VALUES ('Higiene Pessoal');
INSERT INTO `farmacia_db`.`categoria` (`NM_CATEGORIA`) VALUES ('Beleza');

INSERT INTO `farmacia_db`.`forma_uso` (`DESCRICAO`) VALUES ('Via Oral');
INSERT INTO `farmacia_db`.`forma_uso` (`DESCRICAO`) VALUES ('Pomada');

INSERT INTO `farmacia_db`.`laboratorio` (`NM_LABORATORIO`) VALUES ('EMS');
INSERT INTO `farmacia_db`.`laboratorio` (`NM_LABORATORIO`) VALUES ('Bayer');

INSERT INTO `farmacia_db`.`produto`(`COD_BARRA`,`NM_PRODUTO`,`DT_CADASTRO`,`PRECO`,`ESTOQUE`,`ID_CATEGORIA`)
VALUES( 4800123410113, 'Shampoo Palmolive', NOW(), 12.25, 20 ,1);

INSERT INTO `farmacia_db`.`produto`(`COD_BARRA`,`NM_PRODUTO`,`DT_CADASTRO`,`PRECO`,`ESTOQUE`,`ID_CATEGORIA`)
VALUES(4800123410114, 'Condicionador Palmolive', NOW(), 13.90, 15 ,1);

INSERT INTO `farmacia_db`.`remedio` (`COD_BARRA`,`DOSAGEM`,`COMPOSICAO`,`GENERICO`,`NM_REMEDIO`,`DT_CADASTRO`,`PRECO`,`ESTOQUE`,`ID_FORMA_USO`,`ID_LABORATORIO`)
VALUES( 310012340122, '100mg','Metamizol', 1, 'Dipirona SÃ³dica', NOW(), 24.90, 30, 1, 1);

INSERT INTO `farmacia_db`.`remedio` (`COD_BARRA`,`DOSAGEM`,`COMPOSICAO`,`GENERICO`,`NM_REMEDIO`,`DT_CADASTRO`,`PRECO`,`ESTOQUE`,`ID_FORMA_USO`,`ID_LABORATORIO`)
VALUES( 310012340130, '200mg','Panadol', 0, 'Paracetamol', NOW(), 29.90, 19, 1, 2);
